# Spesifikasjon for SAML for XDS dokumentdeling

## Endringer
### Felt purposeofUse
Endring av displaytext i attributtfeltet purposeofUse for følgende koder fra engelsk til norsk. Dette er teksten som vises som grunnlag i innsynslogg til  innbygger på Helsenorge.no.

* Kode 1:
    * Engelsk tekst: Clinical care provision to an individual subject of care
    * Endret til: Oppslag via kjernejournal, helsehjelp
* Kode 2:
    * Engelsk tekst: Emergency care provision to an individual subject of care
    * Endret til: Oppslag via kjernejournal, akutt helsehjelp
* Kode 5
    * Engelsk tekst: Health service management and quality assurance
    * Endret til: Visning av dokumentliste til saksbehandler

|                                   Attributt                                  |                                                                                                                                                                                                          IHE Beskrivelse                                                                                                                                                                                                         | XUA attributt |                                                                                                              Helsepersonell                                                                                                              | Helsepersonell-Obligatorisk |                                                             Innbygger                                                            | Innbygger-Obligatorisk |                                                                                                                                                                    Kodeverk                                                                                                                                                                   |                                                                                                                                              Attributtformat/Datatype versjon 1                                                                                                                                              |                                                                                                                                                                                                           Attributtformat/Datatypeversjon 2                                                                                                                                                                                                           |            Kilde Helsepersonell           |                                                                             Formål Helsepersonell                                                                            |                                                                      Formål Innbygger                                                                     |
|:----------------------------------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:-------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:---------------------------:|:--------------------------------------------------------------------------------------------------------------------------------:|:----------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:-----------------------------------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------:|
| NameID                                                                       | Identify the subject of a SAML assertion                                                                                                                                                                                                                                                                                                                                                                                         | X             | F-nr (eller annen unik bruker-id hos virksomhet) til innlogget bruker. Inneholder også ID type (OID)                                                                                                                                     | X                           | F-nr til innlogget bruker                                                                                                        | X                      |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | <saml2:Subject><saml2:NameIDNameQualifier="urn:gs1:gln">7601000000000</saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"/></saml2:Subject>'@NameQualifier="urn:oid:2.16.578.1.12.4.1.4.1"                                                                                                                                                                                                                        | HelseID                                   | I utgangspunktet er NPI ment til å brukes for tilgangsstyring for bruker. For nå mest aktuell til logging.                                                                   | Kan sjekke for sperring.                                                                                                                                  |
| subject:subject-id                                                           | Subject contains the logical identifier of the principal performing the original service request (person, application, etc.)Subject ID : The value on the Subject ID attribute shall be a plain text description of the user's name (not user ID).                                                                                                                                                                               | X             | Navn på innlogget bruker                                                                                                                                                                                                                 | X                           | Navn på innlogget bruker                                                                                                         | X                      |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | HelseID                                   | Kun for logging.                                                                                                                                                             | Kun for logging.                                                                                                                                          |
| subject:organization                                                         | The value on Subject Organization attribute shall be a plain text description of the organization: This element shall have the Name attribute set to “urn:oasis:names:tc:xspa:1.0:subject:organization”. In plain text, the organization that the user belongs to shall be placed in the value of the element.                                                                                                                   | X             | Navn på juridisk ansvarlig organisasjon som spørringen kommer fra                                                                                                                                                                        | X                           | Standardverdi: Norsk Helsenett                                                                                                   | X                      |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | Kjernejournal (EPJ Virksomhetssertifikat) | Kun for logging.                                                                                                                                                             | Kun for logging.                                                                                                                                          |
| subject:organization-id                                                      | A unique identifier for the organization that the user is representing in performing this transaction shall be placed in the value of the element. The organization ID may be an Object Identifier (OID), using the urn format (that is, “urn:oid:” appended with the OID); or it may be a URL assigned to that organization.                                                                                                    | X             | Unik id som identifiserer brukerens juridiske ansvarlige organisasjon.Eks: 996374653.                                                                                                                                                    | X                           | Standardverdi orgnr for NHN: 994598759                                                                                           | X                      |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | II (instance identifier) datatype fra HL7 v3Eks: <saml:AttributeValue> <id xmlns="urn:hl7-org:v3" xsi:type="II" extension="1234567890"root="2.16.578.1.12.4.1.4.101" assigningAuthorityName="Enhetsregisteret" displayable="true"/> </saml:AttributeValue>                                                                                                                                                                                            | Kjernejournal (EPJ Virksomhetssertifikat) | Ved tvist den som må stå til ansvar for at konsumenten hadde et gyldig tjenstlig behov. Antar at HelseID har verifisert at det er et gyldig helseforetak.                    | Ved tvist den som må stå til ansvar for at konsumenten hadde et gyldig tjenstlig behov. Antar at HelseID har verifisert at det er et gyldig helseforetak. |
| subject:child-organization                                                   | Name child-organization of the Service Consumer.18.05.2021 Legge id i et nytt felt "subject:child-organization-id" og bruke dette felt til navn                                                                                                                                                                                                                                                                                  |               | Navn Laveste formelle organisasjonsenheten bruker tilhører                                                                                                                                                                               |                             | Ikke i bruk for innbygger                                                                                                        |                        |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | Kjernejournal (EPJ Virksomhetssertifikat) | Kun for logging.                                                                                                                                                             | N/A                                                                                                                                                       |
| subject:facility                                                             | The unique identifier of the organization, sub-organization and facility of the Service Consumer.                                                                                                                                                                                                                                                                                                                                |               | Organisatorisk enhet som bruker tilhører                                                                                                                                                                                                 |                             | Ikke i bruk for innbygger                                                                                                        |                        |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | II (instance identifier) datatype fra HL7 v3Eks: <saml:AttributeValue> <id xmlns="urn:hl7-org:v3" xsi:type="II" extension="1234567890"root="2.16.578.1.12.4.1.4.101" assigningAuthorityName="Enhetsregisteret" displayable="true"/> </saml:AttributeValue>                                                                                                                                                                                            | Kjernejournal                             | Kun for logging.                                                                                                                                                             | N/A                                                                                                                                                       |
| subject:role                                                                 | The code attribute shall contain the role code from the identified Value-Set that represents the role that the XUA user is playing when making the request.                                                                                                                                                                                                                                                                      | X             | Beskrivelse av rolle(r) til innlogget bruker                                                                                                                                                                                             | X                           | Ikke i bruk for innbygger                                                                                                        |                        | =HYPERLINK("http://hl7.org/fhir/ValueSet/participant-role";"For helsepersonell vil kjernejournal benytte volven kodeverk 9060. I norsk profil for XDS metadata er det brukt volven kodeverk 9034. For saksbehandlere skal HL7 FHIR kodesystem ""http://hl7.org/fhir/ValueSet/participant-role"" med valueset som benytter SNOMED CT brukes.") | HL7 CE (Coded Element) dataype fra HL7 v3 spesifikasjonen. Eks:                                                                                                                                                                                                                                                              | HL7 CE datatypeEks: </rim:Value><Role xmlns="urn:hl7-org:v3" xsi:type="CE" code="LE" codeSystem="2.16.578.1.12.4.1.1.9060&ISO" codeSystemName="kategori helsepersonell" displayName="Lege"/>                                                                                                                                                                                                                                                          | Kjernejournal                             | Kan brukes til å sjekke at bruker har en gyldig helsepersonellrolle. For eksempel tilgang for lege eller sykepleier, men ikke tilgang for fotterapeut (som også har HPR-nr). | N/A                                                                                                                                                       |
| homeCommunityId                                                              | The value shall be the Home Community ID (an Object Identifier) assigned to the Community that is initiating the request                                                                                                                                                                                                                                                                                                         | X             | Unik id for Community som initierer forespørselen (register)                                                                                                                                                                             | X                           | OID for nasjonalt samhandlingsområde: 2.16.578.1.12.4.1.7.x.xOID for Community som forespør utenfor nasjonalt samhandlingsområde | X                      | OID for nasjonalt samhandlingsområde:2.16.578.1.12.4.1.7.x.x                                                                                                                                                                                                                                                                                  | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | HelseID                                   | Kan brukes til å kun gi tilgang til de samhandlingssområdene som man har tillit til.                                                                                         | Skal bare være fra nasjonalt samhandlingsområde.                                                                                                          |
| subject:npi                                                                  | A National Provider Identifier (NPI) is a unique identifier issued to health careproviders by their national authority. (e.g., in the United States this is a 10-digit number assigned by the Centers for Medicare and Medicaid Services (CMS)). When a simple string is used there needs to be a mutually agreed upon assigning authority. The Other Provider Identifier can be used to explicitly show the assigning authority | X             | HPR-Nr, eller annen unik id for innlogget bruker                                                                                                                                                                                         | X                           | F-nr til innlogget bruker                                                                                                        | X                      | HPR-Nr: 2.16.578.1.12.4.1.4.4F-Nr: 2.16.578.1.12.4.1.4.1                                                                                                                                                                                                                                                                                      | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | HelseID                                   | Kan brukes til å sjekke om bruker er helsepersonell og om bruker er sperret.                                                                                                 | Kun for logging.                                                                                                                                          |
| subject:provider-identifier                                                  | A unique identifier issued to health care providers by a named authority.                                                                                                                                                                                                                                                                                                                                                        | X             | HPR-Nr og ID-type (OID)                                                                                                                                                                                                                  | X                           | F-nr og ID-type                                                                                                                  | X                      | HPR-Nr: 2.16.578.1.12.4.1.4.4F-Nr: 2.16.578.1.12.4.1.4.1                                                                                                                                                                                                                                                                                      | II (instance identifier) datatype fra HL7 v3Eks: <saml:AttributeValue> <id xmlns="urn:hl7-org:v3" xsi:type="II" extension="1234567890"root="2.16.578.1.12.4.1.4.4" assigningAuthorityName="Helsedirektoratet" displayable="true"/> </saml:AttributeValue>                                                                    | II (instance identifier) datatype fra HL7 v3Eks: <saml:AttributeValue> <id xmlns="urn:hl7-org:v3" xsi:type="II" extension="1234567890"root="2.16.578.1.12.4.1.4.4" assigningAuthorityName="Helsedirektoratet" displayable="true"/> </saml:AttributeValue>                                                                                                                                                                                             | HelseID                                   | Forteller hvilken id-type som er brukt for NPI.                                                                                                                              | Forteller hvilken id-type som er brukt for NPI.                                                                                                           |
| urn:ihe:iti:bppc:2007:docid(Patient Privacy Policy Acknowledgement Document) | When the Authz-Consent Option is supported and a policy identifier needs to be sent, the X Service User shall include the document unique ID of the Patient Privacy Policy Acknowledgement Document or include the Patient Privacy Policy Identifier for a policy that has been previously published encoded as SAML attributes                                                                                                  | X             | Ikke aktuelt per nå for helsepersonell                                                                                                                                                                                                   |                             | Brukes ved representasjonOID-referanse til representasjonskilden                                                                 |                        | 2.16.578.1.12.4.1.7.2.2Eks:2.16.578.1.12.4.1.7.2.2.1: Digital kanal2.16.578.1.12.4.1.7.2.2.2: Analog kanalurn:ihe:iti:bppc:2007:docid                                                                                                                                                                                                         | <OID>                                                                                                                                                                                                                                                                                                                        | =HYPERLINK("http://www.w3.org/2001/XMLSchema";"<saml2:Attribute FriendlyName=""Patient Privacy Policy Acknowledgement Document"" Name=""urn:ihe:iti:bppc:2007:docid"" NameFormat=""urn:oasis:names:tc:SAML:2.0:attrname-format:uri""> <saml2:AttributeValue xmlns:xs=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:type=""xs:anyURI"">urn:oid:1.2.3.xxx</saml2:AttributeValue></saml2:Attribute>") | N/A                                       | N/A                                                                                                                                                                          | Kun for logging.                                                                                                                                          |
| urn:ihe:iti:xua:2012:acp(Patient Privacy Policy Identifier)                  | The policy identifier shall be expressedusing the xs:anyURI data type. The referenced policy identifier is the OID of a published policy.                                                                                                                                                                                                                                                                                        | X             | Ikke aktuelt per nå for helsepersonell                                                                                                                                                                                                   |                             | Brukes ved representasjonOID-referanse til fullmakt som er gitt til bruker                                                       |                        | 2.16.578.1.12.4.1.7.2.1Eks:2.16.578.1.12.4.1.7.2.1.1 : Foreldrerepresentasjon, barn under 122.16.578.1.12.4.1.7.2.1.4:Bekreftet fullmakturn:ihe:iti:xua:2012:acp                                                                                                                                                                              | <OID>                                                                                                                                                                                                                                                                                                                        | =HYPERLINK("http://www.w3.org/2001/XMLSchema";"<saml2:Attribute FriendlyName=""Patient Privacy Policy Identifier"" Name=""urn:ihe:iti:xua:2012:acp"" NameFormat=""urn:oasis:names:tc:SAML:2.0:attrname-format:uri""> <saml2:AttributeValue xmlns:xs=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:type=""xs:anyURI"">urn:oid:1.2.3.yyyy</saml2:AttributeValue></saml2:Attribute>")                 | N/A                                       | N/A                                                                                                                                                                          | Kun for logging.                                                                                                                                          |
| subject:purposeofUse                                                         | The PurposeOfUse element shall contain the coded representation of the Purpose for Use that is in effect for the request.                                                                                                                                                                                                                                                                                                        | X             | Årsak til spørringen. For helsepersonell brukes:Kode 1: Clinical care provision to an individual subject of careKode 2: Emergency care provision to an individual subject of careKode 5: Health service management and quality assurance | X                           | Årsak til spørringen. For innsyn innbygger brukes kode 13: Subject of care uses                                                  | X                      | HL7 ISO 14265                                                                                                                                                                                                                                                                                                                                 | HL7 CE (Coded Element) dataype fra HL7 v3 spesifikasjonen. Eks: <PurposeOfUse xmlns="urn:hl7-org:v3" xsi:type="CE" code="1" codeSystem="1.0.14265.1"codeSystemName="ISO 14265 Classification of Purposes for processing personal healthinformation" displayName="Clinical care provision to an individual subject of care"/> | HL7 CE (Coded Element) dataype fra HL7 v3 spesifikasjonen. Eks: <PurposeOfUse xmlns="urn:hl7-org:v3" xsi:type="CE" code="1" codeSystem="1.0.14265.1"codeSystemName="ISO 14265 Classification of Purposes for processing personal healthinformation" displayName="Clinical care provision to an individual subject of care"/>                                                                                                                          | Kjernejournal                             | Kun for logging.                                                                                                                                                             | Kun for logging.                                                                                                                                          |
| resource:resource-id                                                         | The patient identifier attribute shall consist of two parts; the OID for theassigning authority and the identifier of the patient within that assigning authority. The valueshall be formatted using the CX syntax.                                                                                                                                                                                                              | X             | Fødselsnummer og ID-type som identifiserer pasient.                                                                                                                                                                                      | X                           | Identifiserer representert bruker. Inneholder brukers id og id-type                                                              | X                      | OID F-nr:2.16.578.1.12.4.1.4.1                                                                                                                                                                                                                                                                                                                | HL7 CX Datatype. Eks: <Attribute Name="urn:oasis:names:tc:xacml:2.0:resource:resource-id"><AttributeValue>13116900217^^^&amp;2.16.578.1.12.4.1.4.1&amp;ISO</AttributeValue></Attribute>                                                                                                                                      | CX datatype fra HL7 v2.5Eks: <AttributeValue>13116900217^^^&amp;2.16.578.1.12.4.1.4.1&amp;ISO</AttributeValue>                                                                                                                                                                                                                                                                                                                                        | Kjernejournal                             | Kan sjekke om pasienten har gitt tilgang til å dele dokumenter.                                                                                                              | Kan sjekke om pasienten har gitt tilgang til å dele dokumenter.                                                                                           |
| SecurityLevel                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                  |               | Tilpasset attributt for sikkerhetsnivå 1-4, og eIDAS (Low, Substantial,High)                                                                                                                                                             | X                           | Tilpasset attributt for sikkerhetsnivå 1-4, og eIDAS (Low, Substantial,High)                                                     | X                      | Sikkerhetsnivå: 4                                                                                                                                                                                                                                                                                                                             | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | HelseID                                   | Kan sjekke om token har riktig sikkerhetsnivå.                                                                                                                               | Kan sjekke om token har riktig sikkerhetsnivå.                                                                                                            |
| Scope                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                  |               | Standardverdi: journaldokumenter_helsepersonell                                                                                                                                                                                          | X                           | Dataområder/elementer om personen det gjøres oppslag på har tilgang til. Eks: kritiskinfo, egne dokumenter…                      | X                      |                                                                                                                                                                                                                                                                                                                                               | String                                                                                                                                                                                                                                                                                                                       | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | HelseID                                   | Kan sjekke at token har riktig scope.                                                                                                                                        | Kan sjekke at token har riktig scope.                                                                                                                     |
| client_id                                                                    | N/A                                                                                                                                                                                                                                                                                                                                                                                                                              |               | Klient ID fra forespørrende system. Hentes fra klient i HelseID STS                                                                                                                                                                      | X                           |                                                                                                                                  |                        |                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                              | String                                                                                                                                                                                                                                                                                                                                                                                                                                                | Kjernejournal                             |                                                                                                                                                                              |                                                                                                                                                           |
